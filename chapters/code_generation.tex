%Phase3
\input{chapters/sections/CodeGeneration.tex}
\section{Design}
This section will cover the design of the code generator in the compiler, both the overall structure of the code generator and its requirements, but also its use of the \acrshort{gpu}.
Lastly it will present how the runtime of the programs could be made more efficient.
\input{chapters/sections/subsections/DesignofCodeGen.tex}
\input{chapters/sections/subsections/GPUCode.tex}
\input{chapters/sections/subsections/Optimisation.tex}
\section{Implementation}
This section will show examples from the \gls{gamble} compiler's source code which generates the object code from a \gls{gamble} program's source code.
This will show the implementation of selected design choices made in the previous chapters.
First an example of how a \texttt{DeclarationNode} is translated into C code will be provided; afterwards the implementation of using the \acrshort{gpu} using OpenCL will be presented.
The compiler starts the code generation by calling an instance of the class \texttt{CodeGenerator} and invoking the method \texttt{GenerateCodeAndWriteToFile}.
This method then makes the \acrshort{ast} accept a CodeGeneratorVisitor and writes its output to a file; while also exporting the object code to a certain directory along with other files needed; the OpenCL kernels used in the program.
The \texttt{outputCode} is a string which starts as an empty string; every visitor then either appends or returns substrings to be appended.
These substrings add appropriate information to the \texttt{outputCode} string as the traversal is ongoing.
\input{chapters/sections/subsections/CodeGenImpl.tex}


In the following section an introduction of a library called SimpleOpenCL will take place.
\input{chapters/sections/subsections/Templates.tex}
\input{chapters/sections/subsections/MakeFile.tex}