%Subphases
\chapter{Contextual Analysis}
Once the source code has passed through the syntax analysis, and thereby is validated in regard to the \acrshort{cfg}, it must be checked for contextual errors.

In the contextual analysis phase semantic errors are checked for, this includes type errors such as type mismatch, e.g. adding a boolean to a float, which may well be adhering to the grammar, but is not a valid arithmetic expression in \gls{gamble}.
Scope checking is also done in the contextual analysis. 
The design and implementation of the contextual analysis as well as how such errors are handled are described in this chapter.

The contextual analysis phase has sub-phases for scope- and type-checking and error reporting.
An illustration of the design for this can be seen on \myref{fig:flowContextual}, both sub-phases scope-checker and type-checker will have its own visitor class implemented.
The diagram shows that if variables are out of scope or type mismatches, it results in errors which will stop the compilation, if no errors occur it results in a decorated \acrshort{ast} which is then used in the next phase of the compiler, code generation.

\input{figures/TikzDiagrams/flowContextual.tex}

\input{chapters/sections/subsections/SymbolTable.tex}

\section{Scope Checking}
As a part of the contextual analysis the compiler must ensure that every reference is valid in their given scope.
The validity of such reference is specific to the rules of the language, this section describes how the compiler upholds the rules listed in \myref{subsec:Scope}.
\input{chapters/sections/subsections/ScopeCheck.tex}

\section{Type Checking}
Another important part of the contextual analysis phase for the compiler is the type checking, which enforces the type system of \gls{gamble}.
This section will cover the design and implementation of the type checking in the compiler.
\input{chapters/sections/subsections/TypeCheck.tex}

\section{Error Handling}
\input{chapters/sections/subsections/ErrorHandling.tex}